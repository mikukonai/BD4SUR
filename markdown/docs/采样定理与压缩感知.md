#!title:    采样定理与压缩感知
#!date:     2020-05-28
#!authors:  Mikukonai
#!cover:    
#!type:     原创
#!tags:     M

#!content

# 电声系统的采样率问题

关于电声系统的采样率问题，有人认为高采样率（例如96kHz、192kHz等）没有价值，有人认为高采样率十分必要。我的观点是，判断一个东西有没有必要，首先要放到具体的场景中去看。

完整的电声系统如下：

模拟信号→LPF→ADC采样→数字信号→（传输）→数字信号→DAC→模拟信号

首先说左侧的LPF。为什么要加这个LPF，因为采样器的输入必须是带限的，否则必然会发生混叠。我们常说人耳能听到的最高频率在20kHz左右，但这并不意味着声音信号本身是带限的。声音信号是不是带限信号，跟能不能听得到没有关系。为了对模拟信号作采样，需要通过LPF将声音信号变成带限的，至少是在人耳能听到的范围内。但是，现实中的LPF都不是理想的，因此在截止频率的选择上就必须留有一定的余量。从这个角度看，截止频率不能过低。

![等响度曲线](./image/info-comm/audio-encoding/equal-loudness-curves.png)

再说采样。采样定理大家都很熟悉，尤其是时域角度的理解已经相当直观了。而在频域上，采样的本质是对输入信号的调制。使用无穷多个等间隔的单位冲激信号（其重复频率即为采样率$f_s$）对带限信号s作采样，实际上相当于把s的频谱在n倍$f_s$处复制了多份，得到了一个周期性的频谱。周期性的频谱对应时域离散的信号，这与时域上的操作是对应的。

到这里，就很容易理解为什么$f_s$如果小于等于信号带宽的2倍，就会发生频谱的混叠，引入混叠失真。因此，在避免混叠的意义上，对于带限信号而言，采样频率至少要高于其带宽的2倍，但是也没必要高太多，因为如果不考虑其他因素，再进一步提高采样频率，不会对原始信号的信息量有任何提升。

简单来说就是，在避免混叠失真的意义上，采样率并非越高越好。

但是对于实际的电声系统而言，凡是物理上可实现的系统，其特性并非理想，因此设计参数时多少要留有一定的余量。再者，系统所引入的失真会在子系统之间逐级传递下去。比如用40kHz的采样率对模拟信号进行采样，但是因为系统本身的缺陷，可能只保留了18kHz以内的成分。再经过后续的编解码、传输、回放等环节的损失，最终传到耳朵里可能就只剩下12kHz了。所以从工程的角度看，高采样率是有意义的，其意义就在于可以为后期处理、传输等环节可能引入的失真，提供一个余量。但是，高采样率就意味着存储和传输需要更高的带宽，这会引入额外的成本，而感知上的提升又不明显。

因此，最终分发时，采用44100Hz、48000Hz这样的采样率是**最经济**的，但是对于母带来说，就显得不合适了。

至于DAC环节，这里有一种非常具有迷惑性的谬论，下面来批判一番。

有人认为，采样率越高越好，如下图：

![ ](./image/info-comm/采样定理谬论.png)

然而这样理解是不正确的，理由如下。

> 模拟正弦波采样，得到的是离散点，你用直线连起来算什么，还说什么光滑不光滑，这就是胡扯了。“连起来”这个操作严格来说是通过一阶保持器进行DAC，是另一方面的问题。你既然用傅里叶变换去分析，那么也应该像答主说的，用正弦波去连接，而不是直线。

从离散的采样点恢复出原始的模拟信号，本质上是一种插值操作。最简单的插值就是零阶保持，另一种更符合直觉的插值是一阶保持，也就是上面所说的“用直线连起来”。

插值的本质是低通滤波。考虑一个完美采样（未发生混叠）的离散信号，使用理想的LPF保留带限部分的频率成分，就可以完美恢复原来的模拟信号。理想LPF对应的时域响应是sinc信号，因此如果一定用“连起来”的思维方式去理解，也应该理解成多个sinc函数的叠加。

![ ](./image/info-comm/理想内插.jpg)

而一阶保持的频率特性不是理想低通，通带外也有一些采样时引入的高频成分被保留，因此会在恢复出来的信号中引入额外的高频成分，例如直线段、转折点等等。

![ ](./image/info-comm/一阶保持.jpg)

综上所述，采样率的选择，应该具体情况具体分析。对于一般的回放、存储等场景来说，48kHz就非常足够了。但是如果作为素材，采样率当然是越高越好，但是也要作好音质和成本的取舍。

比起带宽问题，其实更值得关注的是整个系统上的噪声问题。例如量化编码时会引入量化噪声，等等。再说下去，就是玄学问题了。言多必失，就此打住。

# 压缩感知

调研中

# 参考资料

- 奥本海姆等. **信号与系统（第二版）**[M]. 电子工业出版社, 2017.
